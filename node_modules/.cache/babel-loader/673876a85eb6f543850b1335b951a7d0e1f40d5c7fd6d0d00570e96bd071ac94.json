{"ast":null,"code":"import React,{useState,useEffect}from'react';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function AudioPlayer(){const[audioUrl,setAudioUrl]=useState('');const[loading,setLoading]=useState(false);useEffect(()=>{// Set the initial audio URL to the GCS file location\nsetAudioUrl('https://storage.googleapis.com/marcosargiottitask/audio-buffer.mp3');},[]);const handleAudioExtraction=async()=>{setLoading(true);try{// Fetch the latest video URL from the server\nconst urlResponse=await fetch('https://35.224.219.98:3001/video');if(urlResponse.ok){const{url}=await urlResponse.json();// Trigger audio processing with the latest video URL\nconst audioResponse=await fetch(\"https://35.224.219.98:3001/video/audio?url=\".concat(encodeURIComponent(url)));if(audioResponse.ok){// Append a timestamp to the audio URL to prevent caching\nconst newAudioUrl=\"https://storage.googleapis.com/marcosargiottitask/audio-buffer.mp3?timestamp=\".concat(new Date().getTime());setAudioUrl(newAudioUrl);alert('Audio has been processed and updated.');}else{console.error('Failed to process audio');alert('Failed to process audio');}}else{console.error('Failed to fetch the latest video URL');alert('Failed to fetch the latest video URL');}}catch(error){console.error('Error:',error);alert('Error during the process');}setLoading(false);};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-row items-center justify-center mt-8\",children:[audioUrl&&/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-col items-center justify-center\",children:/*#__PURE__*/_jsx(\"audio\",{controls:true,src:audioUrl,children:\"Your browser does not support the audio element.\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:handleAudioExtraction,disabled:loading,className:\"border-2 border-black py-2 px-3 m-2 roboto-medium rounded-md bg-white tracking-wider\",children:loading?'Processing...':'Process Audio'})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-white text-center\",children:\"To download the audio clip press on the options button of the player\"})]});}export default AudioPlayer;","map":{"version":3,"names":["React","useState","useEffect","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","AudioPlayer","audioUrl","setAudioUrl","loading","setLoading","handleAudioExtraction","urlResponse","fetch","ok","url","json","audioResponse","concat","encodeURIComponent","newAudioUrl","Date","getTime","alert","console","error","children","className","controls","src","onClick","disabled"],"sources":["C:/Users/sargi/Desktop/Task/TaskRepo/ClientRepo/src/Components/AudioPlayer.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\n\r\nfunction AudioPlayer() {\r\n  const [audioUrl, setAudioUrl] = useState('');\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  useEffect(() => {\r\n    // Set the initial audio URL to the GCS file location\r\n    setAudioUrl('https://storage.googleapis.com/marcosargiottitask/audio-buffer.mp3');\r\n  }, []);\r\n\r\n  const handleAudioExtraction = async () => {\r\n    setLoading(true);\r\n    try {\r\n      // Fetch the latest video URL from the server\r\n      const urlResponse = await fetch('https://35.224.219.98:3001/video');\r\n      if (urlResponse.ok) {\r\n        const { url } = await urlResponse.json();\r\n        // Trigger audio processing with the latest video URL\r\n        const audioResponse = await fetch(`https://35.224.219.98:3001/video/audio?url=${encodeURIComponent(url)}`);\r\n        if (audioResponse.ok) {\r\n          // Append a timestamp to the audio URL to prevent caching\r\n          const newAudioUrl = `https://storage.googleapis.com/marcosargiottitask/audio-buffer.mp3?timestamp=${new Date().getTime()}`;\r\n          setAudioUrl(newAudioUrl);\r\n          alert('Audio has been processed and updated.');\r\n        } else {\r\n          console.error('Failed to process audio');\r\n          alert('Failed to process audio');\r\n        }\r\n      } else {\r\n        console.error('Failed to fetch the latest video URL');\r\n        alert('Failed to fetch the latest video URL');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error:', error);\r\n      alert('Error during the process');\r\n    }\r\n    setLoading(false);\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <div className=\"flex flex-row items-center justify-center mt-8\">\r\n        {audioUrl && (\r\n          <div className=\"flex flex-col items-center justify-center\">\r\n            <audio controls src={audioUrl}>\r\n              Your browser does not support the audio element.\r\n            </audio>\r\n          </div>\r\n        )}\r\n        <button onClick={handleAudioExtraction} disabled={loading} className=\"border-2 border-black py-2 px-3 m-2 roboto-medium rounded-md bg-white tracking-wider\">\r\n          {loading ? 'Processing...' : 'Process Audio'}\r\n        </button>\r\n      </div>\r\n      <p className='text-white text-center'>To download the audio clip press on the options button of the player</p>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default AudioPlayer;\r\n\r\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAAC,OAAAC,GAAA,IAAAC,IAAA,gCAAAC,IAAA,IAAAC,KAAA,gCAAAC,QAAA,IAAAC,SAAA,yBAEnD,QAAS,CAAAC,WAAWA,CAAA,CAAG,CACrB,KAAM,CAACC,QAAQ,CAAEC,WAAW,CAAC,CAAGV,QAAQ,CAAC,EAAE,CAAC,CAC5C,KAAM,CAACW,OAAO,CAAEC,UAAU,CAAC,CAAGZ,QAAQ,CAAC,KAAK,CAAC,CAE7CC,SAAS,CAAC,IAAM,CACd;AACAS,WAAW,CAAC,oEAAoE,CAAC,CACnF,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAG,qBAAqB,CAAG,KAAAA,CAAA,GAAY,CACxCD,UAAU,CAAC,IAAI,CAAC,CAChB,GAAI,CACF;AACA,KAAM,CAAAE,WAAW,CAAG,KAAM,CAAAC,KAAK,CAAC,kCAAkC,CAAC,CACnE,GAAID,WAAW,CAACE,EAAE,CAAE,CAClB,KAAM,CAAEC,GAAI,CAAC,CAAG,KAAM,CAAAH,WAAW,CAACI,IAAI,CAAC,CAAC,CACxC;AACA,KAAM,CAAAC,aAAa,CAAG,KAAM,CAAAJ,KAAK,+CAAAK,MAAA,CAA+CC,kBAAkB,CAACJ,GAAG,CAAC,CAAE,CAAC,CAC1G,GAAIE,aAAa,CAACH,EAAE,CAAE,CACpB;AACA,KAAM,CAAAM,WAAW,iFAAAF,MAAA,CAAmF,GAAI,CAAAG,IAAI,CAAC,CAAC,CAACC,OAAO,CAAC,CAAC,CAAE,CAC1Hd,WAAW,CAACY,WAAW,CAAC,CACxBG,KAAK,CAAC,uCAAuC,CAAC,CAChD,CAAC,IAAM,CACLC,OAAO,CAACC,KAAK,CAAC,yBAAyB,CAAC,CACxCF,KAAK,CAAC,yBAAyB,CAAC,CAClC,CACF,CAAC,IAAM,CACLC,OAAO,CAACC,KAAK,CAAC,sCAAsC,CAAC,CACrDF,KAAK,CAAC,sCAAsC,CAAC,CAC/C,CACF,CAAE,MAAOE,KAAK,CAAE,CACdD,OAAO,CAACC,KAAK,CAAC,QAAQ,CAAEA,KAAK,CAAC,CAC9BF,KAAK,CAAC,0BAA0B,CAAC,CACnC,CACAb,UAAU,CAAC,KAAK,CAAC,CACnB,CAAC,CAED,mBACEP,KAAA,CAAAE,SAAA,EAAAqB,QAAA,eACEvB,KAAA,QAAKwB,SAAS,CAAC,gDAAgD,CAAAD,QAAA,EAC5DnB,QAAQ,eACPN,IAAA,QAAK0B,SAAS,CAAC,2CAA2C,CAAAD,QAAA,cACxDzB,IAAA,UAAO2B,QAAQ,MAACC,GAAG,CAAEtB,QAAS,CAAAmB,QAAA,CAAC,kDAE/B,CAAO,CAAC,CACL,CACN,cACDzB,IAAA,WAAQ6B,OAAO,CAAEnB,qBAAsB,CAACoB,QAAQ,CAAEtB,OAAQ,CAACkB,SAAS,CAAC,sFAAsF,CAAAD,QAAA,CACxJjB,OAAO,CAAG,eAAe,CAAG,eAAe,CACtC,CAAC,EACN,CAAC,cACNR,IAAA,MAAG0B,SAAS,CAAC,wBAAwB,CAAAD,QAAA,CAAC,sEAAoE,CAAG,CAAC,EAC9G,CAAC,CAEP,CAEA,cAAe,CAAApB,WAAW"},"metadata":{},"sourceType":"module","externalDependencies":[]}